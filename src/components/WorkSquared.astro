---
import GitHubIcon from './GitHubIcon.jsx';
---

<div class="container">
  <main>
    <img id="logo" src="/worksquared-logo.png" alt="Work Squared" />
    <h1>Work Squared</h1>

    <form
      action="https://buttondown.com/api/emails/embed-subscribe/sociotechnica"
      method="post"
      target="popupwindow"
      onsubmit="handleFormSubmit(event)"
      class="embeddable-buttondown-form"
    >
      <label for="bd-email">Subscribe for updates</label>
      <span class="small">At most once a month.</span>
      <input
        type="email"
        name="email"
        id="bd-email"
        placeholder="Enter your email"
      />
      <input type="hidden" value="work-squared" name="tag" />

      <input type="submit" value="Subscribe" id="subscribe-btn" />
      <div id="success-message" style="display: none;">
        Thanks! Check your email.
      </div>
    </form>
    <footer>
      <a
        href="https://github.com/sociotechnica-org/work-squared"
        target="_blank"
        rel="noopener noreferrer"
        class="github-link"
      >
        <GitHubIcon size={20} client:load />
        <span>View on GitHub</span>
      </a>
      <a
        href="https://sociotechnica.org"
        target="_blank"
        rel="noopener noreferrer"
      >
        A SocioTechnica Exploration
      </a>
    </footer>
  </main>
</div>

<style>
  .container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh; /* Changed from min-height to height */
    text-align: center;
    box-sizing: border-box; /* Add box-sizing to include padding in height calculation */
    padding: 1rem;
  }

  main {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex: 1;
  }

  #logo {
    width: 111px;
    height: 111px;
  }

  h1 {
    font-size: 4rem;
    margin-top: 1rem;
    margin-bottom: 5rem;
    font-weight: 600;
  }

  footer {
    margin-top: 5rem;
    font-size: 0.9rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    align-items: center;
  }

  a {
    color: #666;
    text-decoration: none;
    border-bottom: 1px solid #ddd;
    padding-bottom: 1px;
    transition:
      color 0.2s,
      border-color 0.2s;
  }

  a:hover {
    color: #000;
    border-color: #999;
  }

  .github-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 500;
    border-bottom: none !important;
  }

  .github-link:hover {
    color: #333;
    border-bottom: none !important;
  }

  label {
    display: block;
    font-size: 1.2rem;
    font-weight: 600;
  }

  span.small {
    margin-top: 0.25rem;
    display: block;
    font-size: 0.9rem;
    color: #999;
    font-style: italic;
  }

  input[type='email'] {
    margin-top: 0.5rem;
    padding: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 0.25rem;
    font-size: 1rem;
    width: 100%;
    max-width: 200px;
    text-align: center;
  }

  #subscribe-btn {
    margin-top: 0.5rem;
    padding: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 0.25rem;
    font-size: 1rem;
    cursor: pointer;
    background-color: #fafafa;
    border-color: #ddd;
  }
  #subscribe-btn:hover {
    background-color: #eee;
    border-color: #dedede;
  }

  #success-message {
    margin-top: 0.5rem;
    color: #000;
  }

  @media (max-width: 768px) {
    h1 {
      font-size: 3rem;
    }
  }
</style>

<script is:inline>
  // eslint-disable-next-line no-unused-vars
  function handleFormSubmit(event) {
    const submitBtn = document.getElementById('subscribe-btn');
    const successMessage = document.getElementById('success-message');

    if (!submitBtn || !successMessage) return;

    // Hide the submit button and show success message
    submitBtn.style.display = 'none';
    successMessage.style.display = 'block';

    // Allow the form to submit normally to the popup
    return true;
  }
</script>
